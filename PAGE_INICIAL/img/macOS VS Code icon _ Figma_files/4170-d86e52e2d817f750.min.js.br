"use strict";
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="dcaabad2-816e-558e-bf39-dd3398ef08f7")}catch(e){}}();
(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[4170],{780634:(e,t,n)=>{n.d(t,{Do:()=>u,Du:()=>p,El:()=>h,JO:()=>v,Jx:()=>y,Lp:()=>I,Mc:()=>g,ON:()=>r,RW:()=>_,Rq:()=>d,Vr:()=>f,Vs:()=>C,Y:()=>l,YZ:()=>s,ZF:()=>k,h3:()=>E,hu:()=>m,jG:()=>c,kL:()=>a,qc:()=>i,qp:()=>b,se:()=>o,xn:()=>w});let a="post_to_feed_view--container--BiDZs",o="post_to_feed_view--noContentContainer--VE8Tm post_to_feed_view--container--BiDZs text--fontPos16--oMC-G text--_fontBase--QdLsd",l="post_to_feed_view--searchFilterContainer--lyX72",r="post_to_feed_view--searchBar--IwmvI",i="post_to_feed_view--searchIcon---WXsZ",d="post_to_feed_view--caretIcon--akCZQ",s="post_to_feed_view--pageMenuDropdown--bS4RV",c="post_to_feed_view--scrollContainer--syalR",m="post_to_feed_view--innerScrollContainer--aP8K2",u="post_to_feed_view--loadingSpinnerContainer--E8n20",_="post_to_feed_view--pageSection--85j7J",f="post_to_feed_view--pageHeader--ZOfTF",p="post_to_feed_view--pageHeaderFaint--p-zwO",g="post_to_feed_view--tilesGrid--Ft03l",C="post_to_feed_view--tile--9a4ta",h="post_to_feed_view--selectedTile--D6T9A post_to_feed_view--tile--9a4ta",E="post_to_feed_view--tileThumbnail--FkrR9",y="post_to_feed_view--tileOverlay--iyl2x",v="post_to_feed_view--tileDetails--FZrxQ",b="post_to_feed_view--nodeName--jbJro",w="post_to_feed_view--thumbnail--uAumv",I="post_to_feed_view--notFoundContainer--5cMl3 text--fontPos16--oMC-G text--_fontBase--QdLsd",k="post_to_feed_view--searchQuery--TIyhI"},470400:(e,t,n)=>{n.d(t,{CQ:()=>i,DA:()=>v,Ev:()=>x,Fd:()=>u,Hc:()=>o,JT:()=>S,KG:()=>b,OW:()=>N,RO:()=>g,Ru:()=>k,UD:()=>s,YI:()=>_,_5:()=>F,_f:()=>d,aF:()=>c,ku:()=>h,lt:()=>E,oW:()=>I,oj:()=>T,pb:()=>f,q3:()=>y,w8:()=>l,wg:()=>w,xe:()=>r,y3:()=>a,yD:()=>m,zE:()=>C,zb:()=>p});let a="create_feed_post_modal--avatarFloat--iIveN",o="create_feed_post_modal--modalHeader---WjMY permissions_modal--fileTitle--487xP",l="create_feed_post_modal--addBorder--ioWGk",r="create_feed_post_modal--contentContainerV2--QwkuY",i="create_feed_post_modal--buttonRowV3--5nAjk modal--buttonRow--o2A0S",d="create_feed_post_modal--buttonRowLeft--TRB9A",s="create_feed_post_modal--buttonContainer--eO4q8",c="create_feed_post_modal--inputSectionMinimized--bq7wz create_feed_post_modal--inputSection--7p1jN",m="create_feed_post_modal--inputFields--bFFV7",u="create_feed_post_modal--draftText--n3VG5",_="create_feed_post_modal--postLoadingSpinner--rky-A",f="create_feed_post_modal--postButton--kaBoj",p="create_feed_post_modal--postingButton--VH5JE create_feed_post_modal--postButton--kaBoj",g="create_feed_post_modal--modalWrapper--4Bi1n",C="create_feed_post_modal--modalWrapperMinimized--syjBM create_feed_post_modal--modalWrapper--4Bi1n",h="create_feed_post_modal--contentNonEmpty--vTrJ6",E="create_feed_post_modal--contentWrapperMinimizedV2--Y56bB create_feed_post_modal--contentWrapperV2--CuYTA",y="create_feed_post_modal--contentWrapperV3--bCplT create_feed_post_modal--contentWrapperV2--CuYTA",v="create_feed_post_modal--descriptionWrapperV3--KrwNd",b="create_feed_post_modal--avatarAndDescriptionWrapperMinimized--yrvzI create_feed_post_modal--avatarAndDescriptionWrapper--JTvU3",w="create_feed_post_modal--minimizedButtonContainerV2--ZJZV- create_feed_post_modal--minimizedButtonContainer--fxgaf",I="create_feed_post_modal--containerPicker--gOWkH",k="create_feed_post_modal--containerPickerTextDisabled--rvG3l",x="create_feed_post_modal--containerButtonDisabled--Qtxk7 create_feed_post_modal--containerButton--CgmgL",T="create_feed_post_modal--containerButtonInner--AiLpd",S="create_feed_post_modal--containerButtonText--99vNr",N="create_feed_post_modal--caret--dGHxv",F="create_feed_post_modal--loadingWrapper--mesOB"},290237:(e,t,n)=>{n.d(t,{X:()=>o});var a=n(547807);let o=new class{constructor(){this.GetDefaultContainerSchemaValidator=(0,a.vh)(),this.SetDefaultContainerSchemaValidator=(0,a.vh)()}getDefaultContainer(e){return this.GetDefaultContainerSchemaValidator.validate(async({xr:t})=>await t.get(`/api/feed_default_container/${e.orgId}`))}setDefaultContainer(e){return this.SetDefaultContainerSchemaValidator.validate(async({xr:t})=>await t.post("/api/feed_default_container",a.td.toAPIParameters(e)))}}},740645:(e,t,n)=>{n.r(t),n.d(t,{CreateFeedPostContent:()=>e_,CreateFeedPostModal:()=>eu,getUploadErrorMessage:()=>em});var a=n(411855),o=n(188507),l=n(629019),r=n.n(l),i=n(776250),d=n(935283),s=n(609494),c=n(358145),m=n(966712),u=n(418956),_=n(498750),f=n(860601),p=n(395900),g=n(743282),C=n(27087),h=n(448169),E=n(946689),y=n(493323),v=n(574176),b=n(630949),w=n(881388),I=n(939863),k=n(392592),x=n(67294),T=n(738269),S=n(507877),N=n(662275),F=n(694687),D=n(860178),M=n(99506),P=n(204279),O=n(531827),A=n(28588),B=n(103271),L=n(290237),R=n(320063),K=n(763223),W=n(849291),U=n(318812),z=n(309798),H=n(397065),$=n(340514),G=n(864114),V=n(463546),Q=n(919960);function Z(){let e=(0,W.e)({overlay:V.K69,priority:H.N.DEFAULT_MODAL}),t=(0,U.B)(Q.lU),n=(0,K.w)(),o=!!(0,z.f)("has_seen_feed_audience_selection_overlay"),l=a.useMemo(()=>!o&&!!n&&!t.showing,[o,n,t.showing]);return(0,R.h)(()=>{l&&e.show()}),a.useEffect(()=>{t.showing&&e.complete()},[t.showing,e]),a.createElement($.rq,{isShowing:e.isShowing,zIndex:G.R.MODAL,targetKey:"feed-audience-container-selection-nux",trackingContextName:"Team feed first audience container selection",title:a.createElement(I.Tx,{id:"rcs.feed_onboarding.audience_selection.title"}),description:a.createElement("p",{"data-testid":"team-feed-first-time-post"},a.createElement(I.Tx,{id:"rcs.feed_onboarding.audience_selection.content"})),onClose:e.complete,userFlagOnShow:"has_seen_feed_audience_selection_overlay",emphasized:!0})}var j=n(49218),q=n(261076),X=n(126674),Y=n(679736),J=n(406158),ee=n(301799),et=n(583630),en=n(660040),ea=n(563288),eo=n(160156),el=n(339617),er=n(782680),ei=n(988898),ed=n(470400),es=n(112512);let ec=[Y.My.CONTEXT_MENU,Y.My.SHARE];function em(e){switch(e.type){case A.Wn.MAX_UPLOADS_EXCEEDED:return(0,I.t)("fig_feed.too_many_content_items",e.params);case A.Wn.MAX_VIDEO_SIZE_EXCEEDED:return(0,I.t)("fig_feed.video_file_size_limit_MB",e.params);case A.Wn.MAX_IMAGE_SIZE_EXCEEDED:return(0,I.t)("fig_feed.image_file_size_limit_MB",e.params);case A.Wn.INVALID_FILE_TYPE:return(0,I.t)("fig_feed.unsupported_file_types_were_not_uploaded",e.params);case A.Wn.DUPLICATE_FILE_UPLOAD:return(0,I.t)("fig_feed.already_uploaded_items",e.params);case A.Wn.FAILED_TO_UPLOAD:return(0,I.t)("fig_feed.error_on_feed_post_creation",e.params);default:(0,d.xb)(e)}}function eu(e){let t=(0,o.wA)(),n=(0,F.sZ)(),l=(0,q.R)(),r=a.useCallback(()=>{t(N.Ce())},[t]),i=((null==n?void 0:n.name)&&a.createElement(I.Tx,{id:"fig_feed.post_to_org_feed",orgName:n.name}))??a.createElement(I.Tx,{id:"fig_feed.post_to_feed"});return a.createElement(j.hZ,{header:a.createElement("div",{className:ed.Hc},i),onClose:()=>l(r),maxWidth:j.Fo,disableFixedTop:!0,closeOnEsc:!0},a.createElement(e_,{nodeInfo:e.nodeInfo,uploadInfo:e.uploadInfo,prototypeInfo:e.prototypeInfo,pageBackgroundColor:e.pageBackgroundColor,onSubmitSuccess:e.onSubmitSuccess,entryPoint:e.entryPoint,lockedFileKey:e.lockedFileKey}))}function e_(e){var t,n;let l=(0,o.wA)(),d=(0,F.sZ)(),R=(0,D.iZ)(),[K,W]=(0,u.fp)(q.T),[U,z]=a.useState(!1),[H,$]=a.useState(!0),[G,V]=a.useState(!1),[eu,e_]=a.useState(!1),[ef,ep]=a.useState((0,I.t)("fig_feed.title_input_placeholder")),eg={id:(null==d?void 0:d.id)??"",type:M.Gr.ORG,name:(null==d?void 0:d.name)??"",isPrivate:!1},[eC,eh]=a.useState(eg),[eE,ey]=a.useState(eg);a.useEffect(()=>{d&&L.X.getDefaultContainer({orgId:null==d?void 0:d.id}).then(({data:e})=>{if(e.meta){let t={id:e.meta.container_id,type:(0,ea.Ti)(e.meta.container_type),name:e.meta.container_name,isPrivate:e.meta.is_private};ey(t),eh(t)}})},[d]);let[ev,eb]=a.useState(e.nodeInfo??null),ew=e.setMinimized,eI=a.useCallback(e=>{ew&&ew(e)},[ew]),ek=(0,o.d4)(e=>e.modalShown),[ex,eT]=a.useState((0,g.g)()),[eS,eN]=a.useState(0),eF=a.useCallback(()=>{eQ(""),ej([]),eI(!0),V(!1),eL([]),eT((0,g.g)()),eN(0),eb(null)},[eI]),eD=a.useCallback(()=>{l((0,N.to)({type:er.h,data:{onConfirm:eF},showModalsBeneath:!0}))},[l,eF]),eM=()=>{ep(B.ZP[Math.floor(Math.random()*B.ZP.length)]())};a.useEffect(()=>{eM()},[]);let eP=e.pageBackgroundColor,eO=(null==ev?void 0:ev.fileKey)??(null==(t=e.prototypeInfo)?void 0:t.fileKey)??"";a.useEffect(()=>{let t={entryPoint:e.entryPoint};eO&&(t.fileKey=eO),(0,i.sx)("Team Feed Create Post Modal Opened",t)},[e.entryPoint,eO]);let eA=a.useCallback((e,t)=>{if(t){l(N.Ce());return}let n={text:(0,I.t)("fig_feed.view_post"),action:()=>{l(S.V3({url:(0,X.Kc)(d.id,{uuid:e})}))}};l(k.F.enqueue({message:(0,I.t)("fig_feed.posted_to_org_feed",{orgName:d.name}),button:n})),l(N.Ce())},[l,d]),[eB,eL]=a.useState([]),eR=a.useMemo(()=>new Set(eB.map(e=>e.displayContentItem.type===B.cM.NODE?e.displayContentItem.nodeId:null).filter(e=>null!==e)),[eB]);a.useEffect(()=>{(0,ee.sr)(ev,eR,eL,null==d?void 0:d.id,eP)},[ev,eR,eL,null==d?void 0:d.id,eP]);let eK=a.useRef(null);a.useEffect(()=>{let t=e.prototypeInfo;if(!(null==d?void 0:d.id)||!t||eK.current)return;let n=(0,J.WI)(t,d.id);eK.current=n.displayContentItem,eL(e=>[...e.filter(e=>e.displayContentItem.type!==B.cM.PROTOTYPE),n])},[null==d?void 0:d.id,e.prototypeInfo]);let eW=a.useCallback(e=>{let t=(0,eo.K1)(eB[eS].displayContentItem);eN(e.findIndex(e=>(0,eo.K1)(e)===t));let n=[];e.forEach(e=>{let t=(0,eo.K1)(e),a=eB.find(e=>(0,eo.K1)(e.displayContentItem)===t);a?n.push(a):console.error("Expected to have a matchedPendingItem")}),eL(n)},[eB,eS]),eU=a.useCallback(e=>{eN(eB.findIndex(t=>(0,eo.K1)(t.displayContentItem)===e))},[eB]),{setContentPreview:ez,snapshotStates:eH}=(0,ee.eh)(eB,eL),{onSubmitSuccess:e$}=e,eG=a.useCallback((t,n)=>{C.Ay.post("/api/feed_posts",t).then(t=>{ec.includes(e.entryPoint)?eA(t.data.meta.public_uuid,n):(eF(),eM()),n&&l(k.F.enqueue({message:(0,I.t)("fig_feed.post_submission_pending")})),e$&&e$(n)}).catch(()=>{l(w.s.error((0,I.t)("fig_feed.error_on_feed_post_creation"))),$(!1)})},[l,eA,e$,eF,e.entryPoint]),[eV,eQ]=a.useState(""),[eZ,ej]=a.useState([]),eq=a.useMemo(()=>({library:new O.M8(d.id)}),[d]);a.useEffect(()=>{$(eV.trim().length>en.Y||(0,s._Z)(eZ).length>en.e||0===eB.length)},[eV,eZ,eB.length]),a.useEffect(()=>{let e=eV.trim().length>0||!(0,s.I)(eZ);z(e||eB.length>0),W(e)},[eZ,W,eV,eB.length]);let eX=e.lockedFileKey||(null==ev?void 0:ev.fileKey),eY=async t=>{let n=new p.M4;if(n.start(),(0,i.sx)("team_feed_onsubmit",{currentOrgPresent:!!d,submitDisabled:H},{logFromProber:!0}),!d||H)return;null==t||t.preventDefault(),$(!0);let a={description_meta:eZ,org_id:d.id};a.background_color=eP;let o=(0,s._Z)(eZ);a.content=await (0,J.pj)(l,eB,eO,eV),(0,i.sx)("team_feed_content_awaited",{payloadContent:JSON.stringify(a.content)},{logFromProber:!0});let r=a.content.some(e=>e.pending);a.uuid=ex,eV?a.title=eV:a.title=o.length>0?o.slice(0,40)+"\u2026":(0,I.t)("fig_feed.untitled_post"),eC.id&&eC.type&&(a.container_id=eC.id,a.container_type=(0,ea.FD)(eC.type)),eX&&(a.attached_file_key=eX),eG(a,r),n.stop(),(0,i.sx)("team_feed_click_to_post_latency",{elapsedTimeMs:n.getElapsedTime()},{forwardToDatadog:!0}),(0,i.sx)("Team Feed New Post Submitted",{fileKey:eO,entryPoint:e.entryPoint,text:o,numContentItems:a.content.length,contentItemTypes:a.content.map(e=>e.type),containerId:a.container_id,containerType:a.container_type,isCurrentDefaultContainer:a.container_id===eE.id&&a.container_type===eE.type},{forwardToDatadog:!0})},eJ=a.useCallback((e,t)=>{if(!d)return;let n=Array.from(e);if(0===n.length)return;let a=(0,P.KT)(n,eB.length,B.e3,B.bB,e=>{l(k.F.enqueue({message:em(e)}))},eB.map(e=>e.fileIdentifier)).map(e=>{let t=(0,P.Fn)(e);if(A.xp.includes(e.type))return(0,J.zr)(t,e);if(A.VY.includes(e.type))return(0,J.X2)(t,ex,d.id,e);throw Error("unexpected file type")}),o=void 0!==t?t:eB.length;eL(e=>[...e.slice(0,o),...a,...e.slice(o)]),eN(o)},[l,d,ex,eB]),e0=a.useCallback((e,t)=>()=>{var n;let a=(null==(n=e.current)?void 0:n.files)||null;null!==a&&0!==a.length&&(eJ(a,t),eI(!1),e.current&&(e.current.value=""))},[eJ,eI]),e1=(0,c.Z)(e.uploadInfo);a.useEffect(()=>{e.uploadInfo&&e.uploadInfo!==e1&&(eI(!1),eJ(e.uploadInfo))},[e.uploadInfo,e1,eI,eJ]);let e6=a.useCallback(e=>{let t=Math.min(e,Math.max(0,eB.length-2)),n=eB[e];if((0,J.AK)(n),eL(t=>t.filter((t,n)=>n!==e)),n.displayContentItem.type===B.cM.NODE){let e=n.displayContentItem.nodeId;eb(t=>{if(t){let n=t.nodeIds.filter(t=>t!==e),a=t.nodeThumbnails,o=a&&n.reduce((e,t)=>(e[t]=a[t],e),{});return{...t,nodeIds:n,nodeThumbnails:o}}return null})}eN(t)},[eB]),e3=a.useCallback((e,t)=>{eJ(e.files,t),e_(!1)},[eJ]),e8=a.useRef(null),e2=!!(null==(n=null==ev?void 0:ev.nodeIds)?void 0:n.length),{openPostFromFileModal:e9,attachedFileData:e7}=(0,ee.Ld)({setLinkedFileNodeInfo:eb,numUserContentItems:eB.length,hasNodeContent:e2,parentModalRef:e8,attachedFileKey:eX,lockedFileKey:e.lockedFileKey,currentOrgId:null==d?void 0:d.id}),e4=a.useCallback(()=>{let e=eB.map(e=>e.displayContentItem);return a.createElement(h.Y,{className:r()(ed.xe,eu&&ed.w8),isDragTarget:()=>!0,onTargetDragEnter:()=>e_(!0),onTargetDragLeave:()=>e_(!1),onTargetDrop:e=>e3(e)},a.createElement(eo.Zo,{contentItems:e,staticContent:!0,scrollable:!1,deleteItemAtIdx:G?void 0:e6,pageBackgroundColor:eP,onReorderCallback:G?void 0:eW,shouldScrollToIndex:null,selectedIdx:eS,setSelectedIdx:eN,onFileInputChange:e0,setSelectedContent:eU,snapshotStates:eH,setContentPreview:ez,openPostFromFileModal:e9,attachedFile:e7,dragging:eu,mode:"create"}))},[eP,eu,eW,e6,G,eB,e3,eS,e0,eU,eH,ez,e9,e7]),e5=a.useCallback(e=>{e.keyCode===_.Uz.ESCAPE&&eI(!0)},[eI]),te=a.useCallback(()=>{ek||(U&&(eQ(e=>e.trim()),(0,s.I)(eZ)&&ej([])),eI(!0))},[eZ,eI,ek,U]),tt=a.useCallback(()=>{te(),l(N.Ce())},[l,te]),tn=a.createElement("div",{className:r()(ed.zE,K&&ed.ku),onKeyDown:e.disabled?f.lQ:e5,role:"textbox",tabIndex:0,onClick:()=>!e.disabled&&eI(!1)},R&&a.createElement("div",{className:ed.y3},a.createElement(el.A,{user:R,size:x.Pf.LARGE})),a.createElement("div",{className:ed.lt},a.createElement("div",{className:ed.KG},a.createElement("div",{className:ed.aF},a.createElement("div",{className:ed.yD},eV||ef," ",eV&&a.createElement("span",{className:ed.Fd},(0,I.t)("fig_feed.draft")))),a.createElement("div",{className:ed.wg},a.createElement(E.$$,{disabled:!0,dataTestId:"feed-post-post"},a.createElement(I.Tx,{id:"fig_feed.post"})))))),ta=a.createElement("div",{className:ed.RO,onKeyDown:e5,role:"textbox",tabIndex:0,onClick:()=>eI(!1),ref:e8},a.createElement("div",{className:ed.q3},e4(),d&&R?a.createElement("div",{className:ed.DA},a.createElement(et.FeedPostUnifiedComposer,{user:R,currentOrgId:d.id,autofocus:!0,mentionables:eq,onSubmit:H?void 0:eY,submitOnEnter:!1,hideSubmitButton:!0,description:eZ,updateDescription:ej,title:eV,updateTitle:eQ,displayDecoratorsDownwards:!0,minimized:e.minimized,readOnly:G,editableTypeaheadClass:ei.up,openPostFromFileModal:()=>e9({skipFrameSelection:!e2}),fileData:e7,lockFileAddition:eB.length>=B.e3,parentRef:e8,canUnlinkFile:!e2&&!e.lockedFileKey,unlinkFile:()=>eb(null)})):null),a.createElement("div",{className:ed.CQ},a.createElement("div",{className:ed._f},a.createElement("div",{className:b.cx.flex.itemsCenter.$},a.createElement(I.Tx,{id:"fig_feed.post_to"}),a.createElement(Q.zr,{dropdownId:Q.lU,orgId:d.id,defaultContainer:eE,selectedContainer:eC,onContainerSelect:e=>{eh(e),l(T.oB())},onSetDefaultContainer:ey,hideAllSpaces:!0,showMemberCount:!0,showUnusedContainers:!0},a.createElement("div",{className:b.cx.flex.justifyCenter.itemsCenter.ml8.pr4.pl8.h32.maxW300.borderBox.bRadius5.colorBorder.b1.bSolid.overflowHidden.selectNone.$,"data-onboarding-key":"feed-audience-container-selection-nux"},a.createElement(Q.xM,{option:eC,defaultContainer:eE,showMemberCount:!1}),a.createElement("div",{className:ed.OW},a.createElement(v.B,{svg:es.A})))),a.createElement(Z,null))),a.createElement("div",{className:ed.UD},!ec.includes(e.entryPoint)&&(U?a.createElement(E.nR,{onClick:e=>{e.stopPropagation(),eD()}},a.createElement(I.Tx,{id:"fig_feed.discard_draft"})):a.createElement(E.nR,{onClick:e=>{e.stopPropagation(),eF()}},a.createElement(I.Tx,{id:"general.cancel"}))),a.createElement(E.$$,{onClick:e=>{if(!G)return V(!0),eY(e).finally(()=>{V(!1)})},disabled:H,dataTestId:"feed-post-post",className:G?ed.zb:ed.pb},G&&a.createElement("div",{className:ed.YI},a.createElement(y.kt,{shouldMatchTextColor:!0,size:"medium"})),G?a.createElement(I.Tx,{id:"fig_feed.posting"}):a.createElement(I.Tx,{id:"fig_feed.post"}))))),to=((null==d?void 0:d.name)&&a.createElement(I.Tx,{id:"fig_feed.post_to_org_feed",orgName:d.name}))??a.createElement(I.Tx,{id:"fig_feed.post_to_feed"});return d&&R&&(0,m.kc)().xr_debounce_threshold?e.entryPoint===Y.My.FEED_HEADER?a.createElement(a.Fragment,null,tn,!e.minimized&&a.createElement(j.hZ,{header:a.createElement("div",{className:ed.Hc},to),onClose:tt,maxWidth:j.Fo,disableFixedTop:!0},ta)):ta:null}},301799:(e,t,n)=>{let a;n.d(t,{sr:()=>H,eh:()=>G,Ld:()=>$});var o=n(411855),l=n(109388),r=n(188507),i=n(539321),d=n(939863),s=n(392592),c=n(662275),m=n(421123),u=n(691205),_=n(103271),f=n(406158),p=n(160156),g=n(629019),C=n.n(g),h=n(935283),E=n(540193),y=n(748185),v=n(823810),b=n(860601),w=n(768137),I=n(493323),k=n(827586),x=n(860178),T=n(498606),S=n(237870),N=n(761939),F=n(998966),D=n(706638),M=n(227795),P=n(585878);let O="post_from_file_modal--grid--JdmAi",A="post_from_file_modal--searchLoadingSpinnerContainer---qSgU post_from_file_modal--loadingSpinnerContainer--QaXkG";var B=n(647173);let L=`https://${window.location.host}`;var R=((a=R||{})[a.SELECT_FILE=1]="SELECT_FILE",a[a.SELECT_NODE=2]="SELECT_NODE",a);function K(e){let t=o.useRef(null),n=(0,x.TA)(),a=encodeURIComponent(`${e.selectedFile.url}?fuid=${n}&post-to-feed=1&force-incremental=0`),l=`${L}/embed?integration_host=fig-feed&url=${a}`,[r,i]=o.useState(!1),[s,c]=o.useState([]);o.useEffect(()=>{let e=e=>{if(window.parent.origin!==e.origin)return;let{type:t,data:n}=e.data;t===D.v.LOADED&&i(()=>!0),t===D.v.SELECT_NODE&&c(()=>n??[])};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[]);let m=s.length>0;return o.createElement(o.Fragment,null,!r&&o.createElement("div",{className:"post_from_file_modal--embedLoadingSpinnerContainer--x0E-V post_from_file_modal--loadingSpinnerContainer--QaXkG"},o.createElement(I.kt,{size:"large"})),o.createElement("iframe",{ref:t,className:"post_from_file_modal--iframe--W8QSR",title:"Figma",src:l,scrolling:"no"}),o.createElement("div",{className:"post_from_file_modal--footer--UhneR"},o.createElement(w.$$,{onClick:t=>{var n;t.stopPropagation(),e.setNodeInfo({fileKey:e.selectedFile.key,nodeIds:s.map(e=>e.guid),nodeThumbnails:s.reduce((e,{guid:t,thumbnail:n})=>{let a=new Blob([n]),o=URL.createObjectURL(a);return{...e,[t]:o}},{}),backgroundColorByNode:s.reduce((e,{guid:t,backgroundColor:n})=>n?{...e,[t]:n}:e,{})}),null==(n=e.hideModal)||n.call(e)},disabled:!m},o.createElement(d.Tx,{id:"fig_feed.add_to_post"}))))}function W(e){let t=(0,E.ql)(e.orgId,y.xBc.CAN_EDIT,!1,!0),n="loaded"===t.status,{setSelectedFile:a,onAfterSelect:l}=e,r=o.useCallback(e=>{a(e),l()},[a,l]),[i,s]=o.useState(""),[c,m]=o.useState(null),u=o.useMemo(()=>(null==c?void 0:c.map(e=>e.model.key))??[],[c]),_=(0,v.iu)(u),f=o.useMemo(()=>null===c?null:"loaded"===_.status?c.filter(e=>{var t;return null==(t=_.data[e.model.key])?void 0:t.canEdit}):null,[_,c]),p=o.useCallback(e=>o.createElement("div",{className:"post_from_file_modal--tileContainer--f1mpx",onClick:()=>{r(e)},role:"button",tabIndex:0,key:`tile-${e.key}`},o.createElement("div",{className:"post_from_file_modal--chooseFile--3ABxf"},(0,d.t)("fig_feed.choose_file")),o.createElement(F.GQ,{file:e,currentUser:null,activeFileUsers:[],subtitle:o.createElement(F.lJ,{file:e}),onClick:b.lQ})),[r]),g=o.useMemo(()=>i?f?0===f.length?o.createElement("div",{className:"post_from_file_modal--notFoundContainer--JLJWT text--fontPos16--oMC-G text--_fontBase--QdLsd"},o.createElement("div",null,o.createElement(d.Tx,{id:"community.universal_posting_modal.recent_editable_files_search.no_files_matching",searchQuery:o.createElement(o.Fragment,null,o.createElement("span",{className:"post_from_file_modal--searchQuery--GpUQJ"},i))}))):o.createElement(k.P,{hideScrollbar:!0},o.createElement("div",{className:O},f.map(e=>p(e.model)))):o.createElement("div",{className:A},o.createElement(I.kt,{size:"large"})):t.data&&o.createElement(k.P,{hideScrollbar:!0},o.createElement("div",{className:O},t.data.map(e=>p(e)))),[t.data,f,i,p]);return n?o.createElement(o.Fragment,null,o.createElement("div",{className:"post_from_file_modal--searchContainer--oiMYX"},o.createElement(N.IW,{query:i,setQuery:s,setSearchResults:m,placeholderText:(0,d.t)("fig_feed.search_files")})),g):o.createElement("div",{className:A},o.createElement(I.kt,{size:"large"}))}function U(e){let{setModalPage:t,orgId:n,setSelectedFile:a}=e;return o.createElement(W,{orgId:n,setSelectedFile:a,onAfterSelect:e.skipFrameSelection?e.hideModal:()=>{null==t||t(2)}})}let z=(0,S.Ju)(function(e){let t=(0,r.wA)(),n=()=>{var n,a;t(c.Lo()),null==(a=null==(n=e.parentRef)?void 0:n.current)||a.focus()},[a,l]=o.useState(e.attachedFile),[i,s]=o.useState(e.lockFileSelection||e.attachedFile?2:1),{setFeedPostNodeInfo:m}=e,u=o.useCallback(e=>{l(e),m({fileKey:e.key,nodeIds:[]})},[m]),_=e=>s(()=>e);return o.createElement(P.XV,{title:(()=>{switch(i){case 1:return(0,d.t)("fig_feed.choose_a_file");case 2:return o.createElement("div",{className:C()("post_from_file_modal--leftButtonGroup--ZT4p5",e.lockFileSelection&&"post_from_file_modal--headerPadding--6G68d")},!e.lockFileSelection&&o.createElement(M.K0,{svg:B.A,onClick:()=>_(1),"data-tooltip":(0,d.t)("fig_feed.button.back"),"data-tooltip-type":T.Ib.TEXT})," ",(null==a?void 0:a.name)??"");default:(0,h.xb)(i)}})(),onClose:n,containerClassName:"post_from_file_modal--modalView--qMQ2p",innerContainerClassName:"post_from_file_modal--innerModalView--CfMj1",disableClickOutsideToHide:!0,maxWidth:1===i?1024:680,closeOnEsc:!0},(()=>{switch(i){case 1:return o.createElement(U,{orgId:e.orgId,setModalPage:_,setSelectedFile:u,hideModal:n,skipFrameSelection:e.skipFrameSelection});case 2:if(!a)return null;return o.createElement(K,{selectedFile:a,hideModal:n,setNodeInfo:e.setFeedPostNodeInfo});default:(0,h.xb)(i)}})())},"PostFromFileModal");function H(e,t,n,a,o){if(!a||!e)return;let r=e.nodeIds.filter(e=>!t.has(e));0!==r.length&&(queueMicrotask(()=>{(0,l.flushSync)(()=>{n(t=>[...t,...(0,f.Px)(e.fileKey,r,a)])})}),(0,f.Rl)(e.fileKey,r,a,o,e.nodeThumbnails,e.backgroundColorByNode).then(e=>{n(t=>t.map(t=>t.displayContentItem.type===_.cM.NODE&&t.displayContentItem.isLoading?e[t.displayContentItem.nodeId]:t))}))}function $(e){let{setLinkedFileNodeInfo:t,numUserContentItems:n,hasNodeContent:a,parentModalRef:l,attachedFileKey:i,lockedFileKey:m,currentOrgId:f}=e,p=(0,r.wA)(),g=u.M4.useFile(i).data,C=o.useCallback(e=>{if(!m||e.fileKey===m){if(e.nodeIds.length+n>_.e3){p(s.F.enqueue({message:(0,d.t)("fig_feed.too_many_content_items",{maxNum:_.e3})}));return}t(t=>{let n=e.nodeIds,a=e.nodeThumbnails,o=e.backgroundColorByNode;return t&&e.fileKey===t.fileKey?{fileKey:t.fileKey,nodeIds:[...new Set(t.nodeIds.concat(n))],nodeThumbnails:{...t.nodeThumbnails,...a},backgroundColorByNode:{...t.backgroundColorByNode,...o}}:{fileKey:e.fileKey,nodeIds:n,nodeThumbnails:a,backgroundColorByNode:o}})}},[p,n,m,t]);return{openPostFromFileModal:o.useCallback(e=>{f&&p((0,c.to)({type:z,data:{orgId:f,setFeedPostNodeInfo:C,attachedFile:g,parentRef:l,lockFileSelection:m||g&&a,skipFrameSelection:null==e?void 0:e.skipFrameSelection}}))},[p,f,C,g,m,a,l]),attachedFileData:g}}function G(e,t){return{setContentPreview:o.useCallback((n,a,o)=>{let l=Array.from(e),r=l.findIndex(e=>(0,p.K1)(e.displayContentItem)===n),d=l[r];if(d&&(0,_.aT)(d.displayContentItem)){d.preview={url:a,state:o};let e=d.displayContentItem;e.preview_image_url=a,e.backgroundColor=(0,i.colorToHex)(o.backgroundColor),t(l)}else console.error("expected to find matched content item")},[e,t]),snapshotStates:o.useMemo(()=>e.reduce((e,t)=>(t.preview?e[(0,p.K1)(t.displayContentItem)]=t.preview.state:(0,f.EU)(t.displayContentItem)&&(e[(0,p.K1)(t.displayContentItem)]={x:t.displayContentItem.initialX,y:t.displayContentItem.initialY,zoom:t.displayContentItem.initialZoom,ratio:1,backgroundColor:(0,m.dy)(t.displayContentItem.backgroundColor)}),e),{}),[e])}}},919960:(e,t,n)=>{let a;n.d(t,{zr:()=>j,xM:()=>Z,lU:()=>H,Qn:()=>X});var o=n(411855),l=n(188507),r=n(629019),i=n.n(r),d=n(776250),s=n(297666),c=n(320063);if(443==n.j)var m=n(860601);var u=n(547807),_=n(572206),f=n(268537),p=n(659838),g=n(493323),C=n(827586),h=n(32863),E=n(574176),y=n(24973);function v(e){let{tabs:t,selectedTabKey:n,onTabClick:a}=e;return o.createElement("div",{className:y.vR},t.map(e=>o.createElement("button",{key:e.key,className:e.key===n?y.xR:y.Mf,onClick:()=>a(e.key)},e.label)))}var b=n(630949),w=n(939863),I=n(392592),k=n(738269),x=n(767518);class T{constructor(e,t={list:x.U.getFeedPostCreators,search:x.U.searchFeedPostCreators}){this.api=t,this.orgId=e}async list(){try{let{data:{meta:e}}=await this.api.list({orgId:this.orgId});return e}catch(e){console.error("An error ocurred while trying to fetch feed post creator contacts.",e)}return[]}async search(e){try{let{data:{meta:t}}=await this.api.search({query:e,orgId:this.orgId});return t}catch(e){console.error("An error ocurred while searching for feed post creator contacts.",e)}return[]}maxResultsLength(){return 100}}var S=n(860178),N=n(103271),F=n(498606),D=n(290237),M=n(260262),P=n(771e3),O=n(746806),A=n(563288);let B="feed_list_filters--dropdownOption--L2vCH feed_list_filters--dropdownOptionBase--S-hRH",L="feed_list_filters--containerOptionContentText--D4-Oc";if(443==n.j)var R=n(112512);var K=n(639685),W=n(524289),U=n(630834);let z="feed-user-filter-dropdown",H="feed-container-creation-dropdown";var $=((a=$||{})[a.DEFAULT=0]="DEFAULT",a[a.LIGHT=1]="LIGHT",a);function G(){return o.createElement("div",{className:"feed_list_filters--dropdownSeparator--5CG0F"})}function V(e){let{setSelectedOption:t}=e,n=o.useRef(null),a=o.useRef(""),[l,r]=o.useState(""),[i,d]=o.useState([]),[c,m]=o.useState(!1),{search:u}=e,y=o.useCallback(async e=>{try{m(!0);let t=await u(e);d(t)}catch(e){console.error(e)}finally{m(!1)}},[u]);o.useEffect(()=>{l&&a.current!==l&&y(l),a.current=l},[l,y]);let v=(0,s.s)(r,250),b=o.useCallback(()=>r(""),[]),I=o.useCallback(e=>{v(e)},[v]),{searchInputRef:k,onMouseDown:x,onMouseUp:T,onBlur:S,onSearchChange:N,onSearchKeyDown:F,onClearSearchClick:D,onClearSearchKeyDown:A}=(0,h.ne)({query:l,focusOnMount:!1,clearSearch:b,onChange:I},n),L=o.useCallback(e=>{"Enter"===e.key&&A(e),e.stopPropagation()},[A]),R=o.useCallback(e=>()=>{t(e)},[t]);return o.createElement(M.N,{dropdownId:e.dropdownId,renderDropdown:t=>{let n=o.createElement("div",{className:"feed_list_filters--searchBar--SmGQW",key:"search-bar"},o.createElement(E.B,{className:"feed_list_filters--searchIcon--uk2jc",svg:K.A}),o.createElement(p.L,{className:"feed_list_filters--searchInput--fYyKR",ref:k,placeholder:e.searchPlaceholder,value:l,onChange:N,onKeyDown:F,onMouseDown:x,onMouseUp:T,onBlur:S,style:{width:"100%"},autoFocus:!0}),!!l&&o.createElement("button",{className:"feed_list_filters--closeButton--57DHM",onClick:D,onKeyDown:L},o.createElement(E.B,{svg:U.default}))),a=l?i:e.initialOptions,r=(t,n,a,l)=>{switch(t.optionType){case"no_matching_results":return o.createElement("div",{key:"no-matching-results",className:"feed_list_filters--dropdownOptionNoMatchingResults--QuGf9 feed_list_filters--dropdownOptionBase--S-hRH"},o.createElement(w.Tx,{id:"fig_feed.no_matching_results"}));case"group":let i=`${n}-group`;return o.createElement(o.Fragment,{key:`${n}-frag`},t.label&&o.createElement("div",{className:"feed_list_filters--dropdownGroupHeader--GzXg- feed_list_filters--dropdownOptionBase--S-hRH"},t.label),t.options.map((e,t)=>r(e,t,i)),!l&&o.createElement(G,null));case"option":return o.createElement(f.W.CheckableOption,{key:`${n}-${t.id}${a?`-${a}`:""}`,className:B,onClick:R(t),checked:e.selectedOption===t.id},t.display)}},d=o.createElement(C.P,{maxHeight:e.maxContentHeight,hideScrollbar:!0},e.defaultDisplay&&o.createElement(o.Fragment,null,o.createElement(f.W.CheckableOption,{className:B,onClick:R(null),checked:null===e.selectedOption},e.defaultDisplay),o.createElement(G,null)),c?o.createElement("div",{className:"feed_list_filters--loadingSpinner--Pe67Z"},o.createElement(g.kt,{size:"small"})):a.map((e,t)=>r(e,t,void 0,t===a.length-1))),s=o.createElement(o.Fragment,null,n,o.createElement(G,{key:"initial-separator"}),d);return 1===e.type?o.createElement(O.vx,{title:"",headerSize:"hidden",initialConstraints:{x:"left",y:"bottom"},initialPosition:new _.Mi(t.x,window.innerHeight-t.bottom),initialWidth:300,maxWidth:300,dragHeaderOnly:!1,containerClassName:"feed_list_filters--dropdownModalContainer--17bB-",frameStyle:{borderRadius:"4px"},disableDragging:!0},o.createElement("div",{className:"feed_list_filters--lightDropdown--mlEQW"},s)):o.createElement(P.Cf,{showPoint:!0,targetRect:t,lean:"left",minWidth:300,maxWidth:300,disableDropdownScrollContainer:!0,propagateCloseClick:!0},o.createElement("div",{className:"feed_list_filters--defaultDropdown--723ga"},s))},hideOverflow:!0},e.children)}let Q=(0,u.vh)();function Z(e){let t=e.defaultContainer&&e.option.id===e.defaultContainer.id&&e.option.type===e.defaultContainer.type,n=e.defaultContainer&&!t&&e.setDefaultContainer,a=e.showSecretTeamTooltip&&e.option.isPrivate?(0,w.t)("fig_feed.secret_team_tooltip",{containerName:e.option.name}):void 0;return o.createElement("div",{className:"feed_list_filters--containerOptionWrapper--4u6Op"},o.createElement("div",{className:"feed_list_filters--containerOptionContent--QdBnH","data-tooltip-type":F.Ib.TEXT,"data-tooltip":a},o.createElement(A.lO,{containerInfo:{type:e.option.type},withoutTooltip:!0}),o.createElement("div",{className:"feed_list_filters--containerOptionContentInner--LFrFD"},o.createElement("div",{className:L},e.option.name),e.option.isPrivate&&o.createElement(E.B,{className:"feed_list_filters--containerPrivateIcon--4xKbs",svg:W.A}),t&&o.createElement("div",{className:"feed_list_filters--defaultLabel--cbaPB"},o.createElement(w.Tx,{id:"fig_feed.default_in_parens"})))),e.showMemberCount&&null!=e.option.memberCount&&o.createElement("div",{className:i()("feed_list_filters--containerMemberCountWrapper--0me3F")},o.createElement("div",{className:i()("feed_list_filters--containerMemberCount--it5uh",{"feed_list_filters--hideOnHover--W-LgR":n})},o.createElement(w.Tx,{id:"fig_feed.num_members",numMembers:e.option.memberCount??0})),n&&o.createElement("div",{className:"feed_list_filters--setDefaultContainer--Fjrjh",onMouseDown:t=>{var n;t.stopPropagation(),null==(n=e.setDefaultContainer)||n.call(e,e.option)},role:"button",tabIndex:0},o.createElement(w.Tx,{id:"fig_feed.set_as_default"}))))}function j(e){var t;let n=(0,l.wA)(),[a,r]=o.useState(e.selectedContainer?[{...e.selectedContainer,optionType:"option",display:e.selectedContainer.name??""}]:[]),{onContainerSelect:i,onSetDefaultContainer:s}=e,m=(0,S.iZ)(),u=o.useCallback(t=>{var a,o;(t.id!==(null==(a=e.defaultContainer)?void 0:a.id)||t.type!==(null==(o=e.defaultContainer)?void 0:o.type))&&((0,d.sx)("Team Feed Set Default Audience",{containerId:t.id,containerType:t.type,userId:null==m?void 0:m.id,orgId:e.orgId}),D.X.setDefaultContainer({containerId:t.id,containerType:(0,A.FD)(t.type),orgId:e.orgId}).then(()=>{i(t),s(t),n(I.F.enqueue({message:(0,w.t)("fig_feed.new_default_container_has_been_set")}))}))},[n,e.orgId,i,s,null==m?void 0:m.id,e.defaultContainer]),_=o.useCallback(async t=>{let n=`/api/feed_posts/${e.orgId}/containers`,a=new URLSearchParams;t&&a.append("query",t),e.showMemberCount&&a.append("with_member_count","true"),e.showUnusedContainers&&a.append("with_unused_containers","true");let l=`${n}?${a.toString()}`;try{let n=await Q.validate(async({xr:e})=>await e.get(l)).then(e=>e.data.meta),a=t=>{let n=(0,A.Ti)(t.container_type),a={id:t.container_id,type:n,name:t.display_name,isPrivate:t.is_private,memberCount:t.member_count};return{optionType:"option",...a,display:o.createElement(Z,{option:a,defaultContainer:e.defaultContainer,showMemberCount:e.showMemberCount,setDefaultContainer:u})}},r=(e,t)=>({optionType:"group",label:t,options:e.map(a)}),i=e.selectedContainer&&e.selectedContainer.id&&e.selectedContainer.type&&n.member_results.concat(n.results).some(t=>t.container_id===e.selectedContainer.id&&(0,A.Ti)(t.container_type)===e.selectedContainer.type),d=[];return!i&&e.selectedContainer&&d.push(r([{container_id:e.selectedContainer.id,container_type:(0,A.FD)(e.selectedContainer.type),display_name:e.selectedContainer.name,is_private:e.selectedContainer.isPrivate}],null)),0===n.member_results.length&&0===n.results.length?d.push({optionType:"no_matching_results"}):(n.member_results.length>0&&d.push(r(n.member_results,t?(0,w.t)("fig_feed.your_spaces"):(0,w.t)("fig_feed.your_recent_spaces"))),n.results.length>0&&d.push(r(n.results,t?(0,w.t)("fig_feed.other_spaces"):(0,w.t)("fig_feed.other_recent_spaces")))),d}catch(e){console.error(e)}return[]},[e.orgId,e.showMemberCount,e.showUnusedContainers,e.selectedContainer,e.defaultContainer,u]);(0,c.h)(()=>{_(null).then(e=>r(e))});let f=0;return e.dropdownId===H&&(f=1),o.createElement(V,{dropdownId:e.dropdownId,search:_,searchPlaceholder:(0,w.t)("fig_feed.placeholder.container_search"),defaultDisplay:e.hideAllSpaces?void 0:(0,w.t)("fig_feed.all_spaces"),initialOptions:a,selectedOption:(null==(t=e.selectedContainer)?void 0:t.id)??null,setSelectedOption:t=>{e.onContainerSelect(t)},type:f,maxContentHeight:344},e.children)}function q(e){var t;let[n,a]=o.useState([]),l=o.useMemo(()=>new T(e.orgId),[e.orgId]),r=e=>e.map(e=>({optionType:"option",id:e.id,display:o.createElement("div",{className:L},e.handle),handle:e.handle}));o.useEffect(()=>{l.list().then(e=>a(r(e.slice(0,l.maxResultsLength()))))},[l]);let i=async e=>{let t=await l.search(e);return 0===t.length?[{optionType:"no_matching_results"}]:r(t)};return o.createElement(V,{dropdownId:z,search:i,searchPlaceholder:(0,w.t)("fig_feed.placeholder.user_search"),defaultDisplay:(0,w.t)("fig_feed.all_users"),initialOptions:n,type:0,selectedOption:(null==(t=e.selectedUser)?void 0:t.id)??null,setSelectedOption:t=>e.onUserSelect(t),maxContentHeight:344},e.children)}function X(e){let t=(0,l.wA)(),{setSelectedContainer:n,setSelectedUser:a}=e,r=o.useCallback(e=>{a(e)},[a]),i=e.selectedContainer?e.selectedContainer.name:(0,w.t)("fig_feed.all_spaces").toLocaleLowerCase(),d=e.selectedUser?e.selectedUser.handle:(0,w.t)("fig_feed.all_users").toLocaleLowerCase(),s=e=>o.createElement("div",{className:b.cx.flex.selectNone.overflowHidden.$},o.createElement("span",{className:b.cx.overflowHidden.ellipsis.noWrap.flexShrink1.$},e),o.createElement("div",{className:b.cx.flex.itemsCenter.justifyCenter.w16.colorIcon.$},o.createElement(E.B,{svg:R.A})));return o.createElement(o.Fragment,null,o.createElement("div",{className:b.cx.flex.itemsCenter.justifyBetween.mr8.h64.$},o.createElement("div",{className:b.cx.py12.pr8.$},o.createElement(v,{tabs:e.tabs,selectedTabKey:e.selectedTabKey,onTabClick:t=>{e.setSelectedTabKey(t)}})),e.selectedTabKey===N.S8.All&&o.createElement("div",{className:b.cx.flex.gap16.$},o.createElement("div",{className:b.cx.flex.itemsCenter.gap4.maxW150.overflowHidden.$},o.createElement("label",{id:"feed-space-dropdown-label"},o.createElement(w.Tx,{id:"fig_feed.label.in"})),o.createElement(j,{dropdownId:"feed-container-filter-dropdown",orgId:e.orgId,selectedContainer:e.selectedContainer,onContainerSelect:e=>{n(e),t(k.oB())},defaultContainer:null,onSetDefaultContainer:m.lQ,showMemberCount:!1},s(i))),o.createElement("div",{className:b.cx.flex.itemsCenter.gap4.maxW150.overflowHidden.$},o.createElement("label",{id:"feed-space-dropdown-label"},o.createElement(w.Tx,{id:"fig_feed.label.by"})),o.createElement(q,{dropdownId:z,orgId:e.orgId,selectedUser:e.selectedUser,onUserSelect:r},s(d))))))}}}]);

//# debugId=dcaabad2-816e-558e-bf39-dd3398ef08f7

//# sourceMappingURL=https://admin.figma.com/admin/webpack-artifacts/95dfd14aa7f781083e33d36c521a587033fa64ec/4170-d86e52e2d817f750.min.js.map