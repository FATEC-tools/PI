
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="c55fe635-dea1-5461-8485-3bd8a9999312")}catch(e){}}();
(()=>{"use strict";class e extends WebSocket{constructor(e,o,n){super(e,o),this.onCloseCb=n,this.events=[],this._onopen_=null,this._onmessage_=null,this._onclose_=null,this._onerror_=null,super.onopen=this.onOpen,super.onmessage=this.onMessage,super.onclose=this.onClose,super.onerror=this.onError}onOpen(e){this.events.push({event:"onopen",ev:e}),this.flushIfInitialized()}onMessage(e){this.events.push({event:"onmessage",ev:e}),this.flushIfInitialized()}onClose(e){var o;null==(o=this.onCloseCb)||o.call(this),this.events.push({event:"onclose",ev:e}),this.flushIfInitialized()}onError(e){this.events.push({event:"onerror",ev:e}),this.flushIfInitialized()}flushIfInitialized(){if(this._onmessage_&&this._onopen_&&this._onclose_&&this._onerror_)for(;this.events.length>0;){let{event:e,ev:o}=this.events.shift();switch(e){case"onopen":this._onopen_(o);break;case"onmessage":this._onmessage_(o);break;case"onclose":this._onclose_(o);break;case"onerror":this._onerror_(o)}}}set onopen(e){this._onopen_=e,this.flushIfInitialized()}get onopen(){return this._onopen_}set onmessage(e){this._onmessage_=e,this.flushIfInitialized()}get onmessage(){return this._onmessage_}set onclose(e){this._onclose_=e,this.flushIfInitialized()}get onclose(){return this._onclose_}set onerror(e){this._onerror_=e,this.flushIfInitialized()}get onerror(){return this._onerror_}}let o=window.matchMedia("(prefers-color-scheme: dark)");function n(e){return"system"===e?o.matches?"dark":"light":"dark"===e?"dark":"light"}self.global=self;let i=(e,o,n,i,t,s)=>{if(e)window.userStateXHR={readyState:4,status:200,responseText:e};else if(window.Fig){if(i||!window.INITIAL_OPTIONS.user_data){window.startUserStateXHR=()=>{};return}window.startUserStateXHR=function(e){let o=t;if(!o){o="/api/user/state";var i,r=[];window.INITIAL_OPTIONS.org_id&&r.push("org_id="+window.INITIAL_OPTIONS.org_id),window.INITIAL_OPTIONS.team_id&&r.push("team_id="+window.INITIAL_OPTIONS.team_id),n&&r.push("omit_core_data=1"),e&&r.push("file_key="+e),0!==r.length&&(o+="?"+r.join("&"))}window.userStateXHR=new XMLHttpRequest,window.userStateXHR.open("GET",o);let l=null==(i=window.INITIAL_OPTIONS.user_data)?void 0:i.id;l&&window.userStateXHR.setRequestHeader("X-Figma-User-ID",l),window.userStateXHR.send();var a=window.performance?window.performance.now():-1;window.userStateXHR.addEventListener("load",function(){window.userStateXHRDuration=window.performance?window.performance.now()-a:-1},!1),window.sessionStateXHR=new XMLHttpRequest,window.sessionStateXHR.open("GET",s||"/api/session/state"),l&&window.sessionStateXHR.setRequestHeader("X-Figma-User-ID",l),window.sessionStateXHR.send()};let e="/preload-editor"===location.pathname||"/preload-android-proto"===location.pathname||"/file/new"===location.pathname||"/design/new"===location.pathname||"/slides/new"===location.pathname||"/board/new"===location.pathname,r=window.INITIAL_OPTIONS.editing_file&&window.INITIAL_OPTIONS.editing_file.key;o?window.startUserStateXHR(r):e||window.startUserStateXHR()}};function t(e){return"dark"===e?"1E1E1E":"F5F5F5"}function s(){let e=null;try{e=window.localStorage}catch(e){}return e}let r="global-debug-theme-preference";function l(e){return e?(null==e?void 0:e.getItem(r))||"system":null}let a="chunked-file-load",d=(e,i)=>{var s,d,c;let w=null==(s=window.INITIAL_OPTIONS.user_data)?void 0:s.id,I=window.INITIAL_OPTIONS.tracking_session_id,u=window.INITIAL_OPTIONS.release_manifest_git_commit,_=window.__figmaDesktop,p=null!=_&&(null==(c=null==(d=window.INITIAL_OPTIONS)?void 0:d.feature_flags)?void 0:c.desktop_mp_client_id)?_.clientID:null;window.mpGlobal={version:function(){var e,o,n;if(!(null==(o=null==(e=window.INITIAL_OPTIONS)?void 0:e.feature_flags)?void 0:o.manifest_commit_sha))return 121;let i=null==(n=window.INITIAL_OPTIONS)?void 0:n.cluster_name;if("staging"!==i&&"local"!==i)return 121;let t=window.location.search;if(t.includes("force-client-version")){let e=new URLSearchParams(t).get("force-client-version");if(e){let o=parseInt(e);if(!isNaN(o)&&o>0)return console.log(`!! Overriding client version to ${o}`),o}}return 121}(),sock:null,msgs:[],perfMetrics:[],shouldConnectToMultiplayer:e,url({fileKey:o,role:n,oauthToken:t,nodeIds:s,initialBgColor:r,suppressDecodeErrors:l,connectionType:d,tagForLogging:c,forceViewOnly:_,canvasQuerySkipContainers:h}){var f,g,m,v;if(!e)return"";let O=null;i&&o===i.fileKey&&i.targetFileVersion&&(O=i.targetFileVersion);let T="";("editor"===n||"viewerWithCpp"===n)&&s&&(T+=`&scenegraph-queries-initial-nodes=${s}`);let N=new URLSearchParams(window.location.search),S="true"===N.get("recovery"),L="true"===N.get("merge-on-file-open");"editor"!==n||(null==i?void 0:i.forceIncrementalForEditors)!==1||S||L?((null==i?void 0:i.forceIncrementalForEditors)===0||S||L)&&(T+="&use-incremental-for-editors=0"):T+="&use-incremental-for-editors=1","editor"===n&&(null==(f=window.INITIAL_OPTIONS.feature_flags)?void 0:f.incremental_loading_validation)&&(T+="&incremental-loading-validation=1");let A=1;try{let e=JSON.parse(sessionStorage.getItem("reload_times")||"[0]"),o=e[e.length-1];A=Date.now()-o<5e3?1:0}catch(e){}"editor"===n&&(null==(g=window.INITIAL_OPTIONS.feature_flags)?void 0:g.send_initial_bg_color)||(r="");let P=h;("prototype"===n||"viewer"===n)&&(null==(m=window.INITIAL_OPTIONS.feature_flags)?void 0:m.prototype_fix_sections_ifl)&&(P=!0);let y=(null==(v=window.INITIAL_OPTIONS.feature_flags)?void 0:v.chunked_file_load)&&"initial-load"===d,k=window.INITIAL_OPTIONS.e2e_traffic,R=window.INITIAL_OPTIONS.e2e_test_name;return`${location.protocol.replace("http","ws")}//${location.host}/api/multiplayer/${o}?role=${n}&tracking_session_id=${I}&version=${this.version}&recentReload=${A}&file-load-streaming-compression`+T+(t?"&oauth_token="+t:"")+(w?`&user-id=${w}`:"")+(O?`&target-file-version=${O}`:"")+(u?`&client_release=${u}`:"")+(r?`&initial-bg-color=${r}`:"")+(l?"&suppress-decode-errors":"")+(y?`&${a}`:"")+(y?"&chunk-size=5000":"")+(c?`&tag-for-logging=${c}`:"")+(k?"&e2e_traffic=true":"")+(R?`&e2e_test_name=${R}`:"")+(_?"&force-view-only":"")+(p?`&clientID=${p}`:"")+(P?"&canvas-query-skip-containers":"")},DEBUG_THEME_PREFERENCE_KEY:r,DARK_THEME_MEDIA_QUERY:o,themePreferenceFromLocalStorage:l,getBackgroundColorForTheme:t,getVisibleTheme:n,REQUEST_CHUNKED_FILE_LOAD_PARAM:a,preconnect(o){if(!1!==e){if(this.sock){if(o===this.sock.url&&this.sock.readyState!==WebSocket.CLOSED)return;try{this.sock.close()}catch(e){}}this.sock=new WebSocket(o),this.sock.binaryType="arraybuffer",this.sock.onopen=e=>{this.perfMetrics.push({key:"mp-ws-onopen",ts:performance.now(),nBytes:void 0})},this.sock.onmessage=e=>{let o=new Uint8Array(e.data);this.msgs.push(o),this.perfMetrics.push({key:"mp-ws-onmessage",ts:performance.now(),nBytes:o.length*o.BYTES_PER_ELEMENT})},this.msgs=[],this.perfMetrics=[]}}},i&&mpGlobal.preconnect(mpGlobal.url(i))},c=e=>{let o=()=>{let e=document.createElement("script");return e.type="text/javascript",e.async=!0,e.setAttribute("nonce",window.INITIAL_OPTIONS.csp_nonce),e.crossOrigin="anonymous",e},n=new Promise((n,i)=>{let t=o();t.onload=n,t.src=e,document.head.appendChild(t)});return n.catch(o=>console.error(`Fetching ${e} failed: ${o}`)),n};(()=>{var o,r,a,w,I,u,_,p,h,f,g,m;let{file_minimal_user_state:v,mock_user_state_for_tests_json:O,multiplayer_preconnect_options:T,omit_core_data:N,omit_user_state:S,preload_fullscreen_urls:L,should_connect_to_multiplayer:A,api_user_state_path:P,api_session_state_path:y}=window.EARLY_ARGS||{};if(window.INITIAL_OPTIONS||(window.INITIAL_OPTIONS={}),i(O,!!v,!!N,!!S,P,y),!/iPhone|iPad|iPod/.test(navigator.userAgent)){let n=null==(r=null==(o=window.INITIAL_OPTIONS)?void 0:o.feature_flags)?void 0:r.livegraph_connect_next,i=new URLSearchParams(null==(a=window.INITIAL_OPTIONS)?void 0:a.page_load_token);i.append("userId",(null==(I=null==(w=window.INITIAL_OPTIONS)?void 0:w.user_data)?void 0:I.id)||""),i.append("anonUserId",(null==(u=window.INITIAL_OPTIONS)?void 0:u.anonymous_user_id)||"");let t=!!window.__figmaDesktop;i.append("clientType",t?"desktop":"web"),i.append("clientUrl",document.URL),i.append("commitHash",(null==(_=window.INITIAL_OPTIONS)?void 0:_.release_manifest_git_commit)||"missing");let s=(null==(p=window.INITIAL_OPTIONS)?void 0:p.livegraph_preload_views)||{};i.append("preload",JSON.stringify(s));let l=function(e,o,n){let i,t;if(e)try{let o=new URL(e);t=o.protocol,i=o.host}catch(e){}return(void 0===i||void 0===t)&&("admin.staging.figma.com"===(i=location.host)||"embed.staging.figma.com"===i?i="staging.figma.com":("admin.figma.com"===i||"embed.figma.com"===i)&&(i="www.figma.com"),t=location.protocol),`${"https:"===t?"wss":"ws"}://${i}${o?"/api/livegraph-next":"/api/livegraph"}?${n}`}(null==(h=window.INITIAL_OPTIONS)?void 0:h.figma_url,!!n,i.toString()??"");window.LGEarlyWS=new e(l,void 0,()=>{window.LGEarlyWS=void 0})}if(T&&(T.initialBgColor=function(){var e;return(null==(e=window.INITIAL_OPTIONS.feature_flags)?void 0:e.send_initial_bg_color)?t(n(l(s()))):""}(),T.connectionType="initial-load",T.forceViewOnly=!1,((null==(f=window.INITIAL_OPTIONS)?void 0:f.cluster_name)==="staging"||(null==(g=window.INITIAL_OPTIONS)?void 0:g.cluster_name)==="local")&&(null==(m=s())?void 0:m.getItem("force-vscode"))?T.forceViewOnly=!0:T.forceViewOnly=(null==window?void 0:window.location.ancestorOrigins)&&[...window.location.ancestorOrigins].some(e=>e.startsWith("vscode-webview://"))),d(!1!==A,T),!L&&!/FigmaMobile-Android/.test(navigator.userAgent)&&((null==T?void 0:T.role)==="editor"||(null==T?void 0:T.role)==="viewerWithCpp"||(null==T?void 0:T.role)==="prototype")){let e=(null==T?void 0:T.role)==="prototype"?Fig.prototypeLibURLs:Fig.fullscreenURLs,o=fetch(e["compiled_wasm.wasm"]);o.catch(e=>console.error(`Fetching compiled_wasm.wasm failed: ${e}`));let n=c(e["compiled_wasm.js"]);window.FULLSCREEN_PRELOADS={wasm:o,js:n}}})()})();

//# debugId=c55fe635-dea1-5461-8485-3bd8a9999312

//# sourceMappingURL=https://admin.figma.com/admin/webpack-artifacts/94c0f6a67e4f00f3dbdad423891347c3772f50f2/early-9fe34041edba4531.min.js.map